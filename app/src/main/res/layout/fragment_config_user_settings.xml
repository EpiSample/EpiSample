<?xml version="1.0" encoding="utf-8"?>
<layout xmlns:android="http://schemas.android.com/apk/res/android"
        xmlns:bind="http://schemas.android.com/apk/res-auto"
        xmlns:tools="http://schemas.android.com/tools"
        xmlns:app="http://schemas.android.com/apk/res-auto">

    <data>

        <variable
            name="languageService"
            type="org.taskforce.episample.config.language.LanguageService"/>

        <variable
            name="headerVm"
            type="org.taskforce.episample.config.base.ConfigHeaderViewModel"/>

        <variable
            name="vm"
            type="org.taskforce.episample.config.settings.user.UserSettingsViewModel"/>

    </data>

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical">

        <include
            android:id="@+id/toolbar"
            layout="@layout/app_toolbar"/>

        <android.support.v4.widget.NestedScrollView
            android:layout_width="match_parent"
            android:layout_height="0dp"
            android:layout_weight="1"
            android:fillViewport="true">

            <LinearLayout
                android:layout_width="match_parent"
                android:layout_height="match_parent"
                android:orientation="vertical">

                <RelativeLayout
                    android:id="@+id/user_settings_layout"
                    android:layout_width="match_parent"
                    android:layout_height="wrap_content"
                    android:padding="16dp">

                    <include
                        android:id="@+id/header"
                        layout="@layout/app_config_header"
                        bind:vm="@{headerVm}"/>

                    <TextView
                        android:id="@+id/collectionTitle"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_below="@id/header"
                        android:layout_marginTop="24dp"
                        android:text="@{languageService.getString(vm.collectionTitle)}"
                        android:textColor="@color/textColorDetails"
                        android:textSize="16sp"
                        android:textStyle="bold"
                        tools:text="Collection Settings"/>

                    <LinearLayout
                        android:id="@+id/gpsPrecisionWrapper"
                        android:layout_width="match_parent"
                        android:layout_height="wrap_content"
                        android:layout_below="@id/collectionTitle"
                        android:layout_marginTop="16dp"
                        android:baselineAligned="false">

                        <android.support.design.widget.TextInputLayout
                            android:id="@+id/gpsPreferredPrecisionInputWrapper"
                            android:layout_width="0dp"
                            android:layout_height="wrap_content"
                            android:layout_weight="1"
                            android:hint="@{languageService.getString(vm.gpsPreferredPrecisionHint)}">

                            <android.support.design.widget.TextInputEditText
                                android:id="@+id/gpsPreferredPrecisionInput"
                                android:layout_width="match_parent"
                                android:layout_height="wrap_content"
                                android:inputType="numberDecimal"
                                android:singleLine="true"
                                android:text="@={vm.gpsPreferredPrecision}"
                                android:textSize="16sp"
                                tools:hint="GPS Preferred Precision (m)"/>

                        </android.support.design.widget.TextInputLayout>

                        <android.support.design.widget.TextInputLayout
                            error="@{languageService.getString(vm.gpsMinimumPrecisionError)}"
                            android:layout_width="0dp"
                            android:layout_height="wrap_content"
                            android:layout_weight="1"
                            android:hint="@{languageService.getString(vm.gpsMinimumPrecisionHint)}"
                            bind:errorEnabled="@{vm.gpsMinimumPrecisionErrorEnabled}"
                            bind:errorTextAppearance="@style/errorStyle">

                            <android.support.design.widget.TextInputEditText
                                android:id="@+id/gpsMinimumPrecisionInput"
                                android:layout_width="match_parent"
                                android:layout_height="wrap_content"
                                android:inputType="numberDecimal"
                                android:singleLine="true"
                                android:text="@={vm.gpsMinimumPrecision}"
                                android:textSize="16sp"
                                tools:hint="GPS Minimum Precision (m)"/>

                        </android.support.design.widget.TextInputLayout>

                    </LinearLayout>

                    <TextView
                        android:id="@+id/gpsExplanation"
                        android:layout_width="match_parent"
                        android:layout_height="wrap_content"
                        android:layout_below="@id/gpsPrecisionWrapper"
                        android:layout_marginTop="20dp"
                        android:text="@{languageService.getString(vm.gpsExplanation)}"
                        android:textColor="@color/textColorDetails"
                        android:textSize="14sp"
                        tools:text="EpiSample will force enumerators to wait up to two minutes to record a pointâ€™s location with the preferred precision. If unsuccessful, EpiSample will save the point with a lower precision. If the point does not meet the minimum precision specified, it will be marked invalid for sampling."/>
                </RelativeLayout>

                <RelativeLayout
                    android:layout_width="match_parent"
                    android:layout_height="wrap_content"
                    android:paddingStart="16dp"
                    android:paddingEnd="16dp">

                    <!-- Allow photos during collection -->
                    <CheckBox
                        android:id="@+id/photoEnforcement"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_marginTop="4dp"
                        android:checked="@={vm.photoEnforcement}"/>

                    <TextView
                        android:id="@+id/photoEnforcementTitleText"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_alignBaseline="@id/photoEnforcement"
                        android:layout_marginStart="12dp"
                        android:layout_toEndOf="@id/photoEnforcement"
                        android:text="@{languageService.getString(vm.photoEnforcementTitle)}"
                        android:textSize="16sp"
                        tools:text="Allow photos during collection"/>

                    <!-- Photo compression -->
                    <TextView
                        android:id="@+id/photoCompressionTitle"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_below="@id/photoEnforcement"
                        android:layout_alignStart="@id/photoEnforcementTitleText"
                        android:layout_marginTop="12dp"
                        android:text="@{languageService.getString(vm.photoCompressionHint)}"
                        android:textColor="@color/textColorDetails"
                        android:textSize="12sp"
                        tools:text="Photo Compression Level"/>

                    <Spinner
                        android:id="@+id/photoCompressionSelector"
                        style="@style/Widget.AppCompat.Spinner.Underlined"
                        android:layout_width="match_parent"
                        android:layout_height="wrap_content"
                        android:layout_below="@id/photoCompressionTitle"
                        android:layout_alignStart="@id/photoCompressionTitle"
                        android:adapter="@{vm.photoCompressionAdapter}"/>

                </RelativeLayout>

                <RelativeLayout
                    android:layout_width="match_parent"
                    android:layout_height="wrap_content"
                    android:paddingStart="16dp"
                    android:paddingTop="16dp"
                    android:paddingEnd="16dp">
                    <!-- Require comment during collection-->
                    <CheckBox
                        android:id="@+id/requireComment"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_alignParentStart="true"
                        android:checked="@={vm.requireComment}"/>

                    <TextView
                        android:id="@+id/requireCommentTitle"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_alignBaseline="@id/requireComment"
                        android:layout_marginStart="12dp"
                        android:layout_toEndOf="@id/requireComment"
                        android:text="@{languageService.getString(vm.requireCommentTitle)}"
                        android:textSize="16sp"
                        tools:text="Require comment during collection"/>

                    <TextView
                        android:id="@+id/requireCommentSmallHint"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_below="@id/requireCommentTitle"
                        android:layout_alignStart="@id/requireCommentTitle"
                        android:layout_marginTop="4dp"
                        android:text="@{languageService.getString(vm.requireCommentSmallHint)}"
                        android:textColor="@color/textColorDetails"
                        tools:text="Photos also fulfill this requirement, if enabled."/>

                    <!-- Enforce distance between households -->
                    <CheckBox
                        android:id="@+id/displacementEnforcement"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_below="@id/requireCommentSmallHint"
                        android:layout_alignStart="@id/requireComment"
                        android:layout_marginTop="16dp"
                        android:checked="@={vm.minimumDistanceEnforcement}"/>

                    <TextView
                        android:id="@+id/displacementEnforcementTitle"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_alignBaseline="@id/displacementEnforcement"
                        android:layout_marginStart="12dp"
                        android:layout_toEndOf="@id/displacementEnforcement"
                        android:text="@{languageService.getString(vm.displacementEnforcementTitle)}"
                        android:textSize="16sp"
                        tools:text="Enforce distance between households"/>

                    <android.support.design.widget.TextInputLayout
                        android:id="@+id/minimumDistanceWrapper"
                        android:layout_width="match_parent"
                        android:layout_height="wrap_content"
                        android:layout_below="@+id/displacementEnforcement"
                        android:layout_alignStart="@id/displacementEnforcementTitle"
                        android:layout_marginTop="4dp"
                        android:hint="@{languageService.getString(vm.minimumDistanceHint)}">

                        <android.support.design.widget.TextInputEditText
                            android:id="@+id/minimumDistance"
                            android:layout_width="match_parent"
                            android:layout_height="wrap_content"
                            android:singleLine="true"
                            android:text="@={vm.minimumDistance}"
                            android:textColorHint="@color/textColorDetails"
                            android:textSize="16sp"
                            tools:hint="Minimum Distance (m)"/>

                    </android.support.design.widget.TextInputLayout>

                    <TextView
                        android:id="@+id/displacementEnforcementSmallHint"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_below="@id/minimumDistanceWrapper"
                        android:layout_alignStart="@id/displacementEnforcementTitle"
                        android:text="@{languageService.getString(vm.displacementEnforcementSmallHint)}"
                        android:textColor="@color/textColorDetails"
                        android:textSize="12sp"
                        tools:text="Cannot exceed minimum precision specified above."/>
                </RelativeLayout>

                <RelativeLayout
                    android:layout_width="match_parent"
                    android:layout_height="wrap_content"
                    android:paddingStart="16dp"
                    android:paddingEnd="16dp">

                    <!-- User permissions -->
                    <TextView
                        android:id="@+id/permissionsTitle"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_alignParentStart="true"
                        android:layout_marginTop="12dp"
                        android:text="@{languageService.getString(vm.permissionsTitle)}"
                        android:textColor="@color/textColorDetails"
                        android:textSize="16sp"
                        android:textStyle="bold"
                        tools:text="User Permissions"/>

                    <!-- Allow supervisors to disable photos -->
                    <CheckBox
                        android:id="@+id/supervisorDisablePhotos"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_below="@id/permissionsTitle"
                        android:layout_marginTop="16dp"
                        android:checked="@={vm.supervisorDisablePhotos}"/>

                    <TextView
                        android:id="@+id/supervisorDisablePhotosTitle"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_alignBaseline="@id/supervisorDisablePhotos"
                        android:layout_marginStart="12dp"
                        android:layout_toEndOf="@id/supervisorDisablePhotos"
                        android:text="@{languageService.getString(vm.supervisorDisablePhotosTitle)}"
                        android:textSize="16sp"
                        tools:text="Allow supervisors to disable photos"/>

                    <!-- Require supervisor password -->
                    <CheckBox
                        android:id="@+id/supervisorPassword"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_below="@id/supervisorDisablePhotos"
                        android:layout_marginTop="16dp"
                        android:checked="@={vm.supervisorPasswordEnforcement}"/>

                    <TextView
                        android:id="@+id/supervisorPasswordTitle"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_alignBaseline="@id/supervisorPassword"
                        android:layout_marginStart="12dp"
                        android:layout_toEndOf="@id/supervisorPassword"
                        android:text="@{languageService.getString(vm.supervisorPasswordHint)}"
                        android:textSize="16sp"
                        tools:text="Require supervisor password"/>

                    <EditText
                        android:id="@+id/supervisorPasswordInput"
                        android:layout_width="match_parent"
                        android:layout_height="wrap_content"
                        android:layout_below="@id/supervisorPassword"
                        android:layout_alignStart="@id/supervisorPasswordTitle"
                        android:layout_marginTop="16dp"
                        android:hint="@string/config_user_settings_permissions_password_hint"
                        android:inputType="textPassword"
                        android:text="@={vm.supervisorPassword}"
                        android:textSize="14sp"/>
                </RelativeLayout>
            </LinearLayout>


        </android.support.v4.widget.NestedScrollView>

        <include
            app:vm="@{vm}"
            layout="@layout/bottom_bar"/>
    </LinearLayout>
</layout>